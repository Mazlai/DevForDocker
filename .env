# =============================================================================
# Variables de configuration des ressources pour Docker Compose
# =============================================================================
# Ces variables sont utilisées par la directive `deploy.resources` dans
# docker-compose.yml pour définir les contraintes de ressources.
#
# LIMITS (Maximum autorisé) :
#   - Le conteneur ne peut PAS dépasser ces valeurs
#   - Si la mémoire est dépassée → OOM Killer tue le conteneur
#   - Protège l'hôte contre un conteneur gourmand
#
# RESERVATIONS (Minimum garanti) :
#   - Ressources RÉSERVÉES, même si l'hôte est sous pression
#   - Garantit le démarrage et le fonctionnement minimal
#   - Utilisé par Docker pour le scheduling (placement des conteneurs)
#
# FORMAT :
#   - Mémoire : 512m (mégaoctets), 1g (gigaoctets)
#   - CPU : 0.5 = 50% d'UN core (pas du CPU total)
# =============================================================================

# ===== FRONTEND (Angular + http-server) =====
# http-server est léger (~50-80 Mo), mais Node.js peut avoir des pics
FRONTEND_MEMORY_LIMIT=512m
FRONTEND_MEMORY_RESERVATION=128m
FRONTEND_CPU_LIMIT=0.5
FRONTEND_CPU_RESERVATION=0.1

# ===== BACKEND (PHP-FPM) =====
# Pool de workers PHP. Chaque worker ~30-50 Mo. 256 Mo permet ~5 workers.
# Réservation : au moins 1 worker garanti (64 Mo)
BACKEND_MEMORY_LIMIT=256m
BACKEND_MEMORY_RESERVATION=64m
BACKEND_CPU_LIMIT=0.5
BACKEND_CPU_RESERVATION=0.1

# ===== SERVEUR WEB (Nginx) =====
# Nginx est très léger (~10-20 Mo en idle), 128 Mo est généreux
# Réservation minimale car Nginx fonctionne avec très peu
SERVER_MEMORY_LIMIT=128m
SERVER_MEMORY_RESERVATION=32m
SERVER_CPU_LIMIT=0.25
SERVER_CPU_RESERVATION=0.05

# ===== OUTILS DE SUPERVISION =====
# Portainer : Interface web Go, consomme ~100-150 Mo en usage normal
PORTAINER_MEMORY_LIMIT=256m
PORTAINER_MEMORY_RESERVATION=64m
PORTAINER_CPU_LIMIT=0.25
PORTAINER_CPU_RESERVATION=0.05

# cAdvisor : Collecte de métriques, ~50-80 Mo avec métriques désactivées
CADVISOR_MEMORY_LIMIT=128m
CADVISOR_MEMORY_RESERVATION=32m
CADVISOR_CPU_LIMIT=0.25
CADVISOR_CPU_RESERVATION=0.05
